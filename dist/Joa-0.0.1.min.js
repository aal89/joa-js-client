var JOA=function(){"use strict";function e(e){b.url=e}function t(e){b.header=e}function r(e){var t="",r=Object.keys(g.attribute);if(null!==b.header.gatewayIdentifier&&b.header.gatewayIdentifier.length>0){t+=p,t+=b.header.gatewayIdentifier;for(var n=0;n<r.length;n++){var u=r[n],o=b.header.attribute[u];(null!==o&&o.length>0||o)&&("time"==u?t+=",time":"secret"!==u&&"hash"!==u&&(t+=","+u+"="+o))}t+=h.eol,t.indexOf("vendor=")!==-1?e(null,t):e("no_vendor_attribute_set",null)}else e("no_gatewayidentifier_set",null)}function n(){for(var e=[],t=0;t<C.length;t++){for(var r="",n=C[t],u=Object.keys(n),o=0;o<u.length;o++)r+=n[u[o]]+h.tab;r=r.slice(0,-1)+h.eol,e.push(r)}return e}function u(e,t,r,n,u,o,a,l){var s={id:i(),messageType:m.ZCLReport,eui64:e,endpointId:t||"0x0a",profileId:r||"0xf100",clusterId:n,attributeId:u,dataTypeId:o,timestamp:a,value:l};return C.push(s),s}function o(){C=[]}function a(e){for(var t=0;t<C.length;t++)if(C[t].id===e){C[t];return C.splice(t,1),!0}return!1}function i(){return v++,v}function l(e){r(function(t,r){t?e(t,null):b.header.attribute.hash?b.header.attribute.hash&&b.header.attribute.secret&&b.header.attribute.secret.length>0?e(null,s(r+n())):e("no_secret_set",null):e(null,r+n())})}function s(e){var t=e.indexOf(h.eol);return console.log(JSON.stringify(b.header.attribute.secret+e)),console.log(b.header.attribute.secret+e),console.log(b.md5("waiga6ieGo4eefo2thaQuash4ahc4aidMuniRPCv2:10.32.16.1,vendor=androidnode,time\n1\t0\t\t0x0a\t0xf100\n")),e.slice(0,t)+",hash="+b.md5(b.header.attribute.secret+e)+e.slice(t)}function f(e){l(function(t,r){if(t)e(t,null);else{var n=new XMLHttpRequest,u=r;n.open("POST",b.url,!0),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200==n.status?(o(),e(null,n.responseText)):e(n.statusText,null))},n.send(u)}})}function d(){var e=null;return l(function(t,r){e=t?t:r}),e}var c=null,h={tab:"\t",eol:"\n"},g={attribute:{vendor:null,hash:null,secret:null,time:null},gatewayIdentifier:null},p="MuniRPCv2:",v=0,m={ZCLReport:0,ZCLMultiReport:1,ZCLCommand:2,TAZFrame:3,TimeIndication:"t"},C=[],b=function(e){return b.url=e,this},y=function(e){function t(e,t){return e<<t|e>>>32-t}function r(e,t){var r,n,u,o,a;return u=2147483648&e,o=2147483648&t,r=1073741824&e,n=1073741824&t,a=(1073741823&e)+(1073741823&t),r&n?2147483648^a^u^o:r|n?1073741824&a?3221225472^a^u^o:1073741824^a^u^o:a^u^o}function n(e,t,r){return e&t|~e&r}function u(e,t,r){return e&r|t&~r}function o(e,t,r){return e^t^r}function a(e,t,r){return t^(e|~r)}function i(e,u,o,a,i,l,s){return e=r(e,r(r(n(u,o,a),i),s)),r(t(e,l),u)}function l(e,n,o,a,i,l,s){return e=r(e,r(r(u(n,o,a),i),s)),r(t(e,l),n)}function s(e,n,u,a,i,l,s){return e=r(e,r(r(o(n,u,a),i),s)),r(t(e,l),n)}function f(e,n,u,o,i,l,s){return e=r(e,r(r(a(n,u,o),i),s)),r(t(e,l),n)}function d(e){for(var t,r=e.length,n=r+8,u=(n-n%64)/64,o=16*(u+1),a=Array(o-1),i=0,l=0;l<r;)t=(l-l%4)/4,i=l%4*8,a[t]=a[t]|e.charCodeAt(l)<<i,l++;return t=(l-l%4)/4,i=l%4*8,a[t]=a[t]|128<<i,a[o-2]=r<<3,a[o-1]=r>>>29,a}function c(e){var t,r,n="",u="";for(r=0;r<=3;r++)t=e>>>8*r&255,u="0"+t.toString(16),n+=u.substr(u.length-2,2);return n}function h(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}var g,p,v,m,C,b,y,x,O,A=Array(),S=7,I=12,w=17,L=22,R=5,J=9,M=14,T=20,_=4,Z=11,P=16,j=23,k=6,q=10,H=15,N=21;for(e=h(e),A=d(e),b=1732584193,y=4023233417,x=2562383102,O=271733878,g=0;g<A.length;g+=16)p=b,v=y,m=x,C=O,b=i(b,y,x,O,A[g+0],S,3614090360),O=i(O,b,y,x,A[g+1],I,3905402710),x=i(x,O,b,y,A[g+2],w,606105819),y=i(y,x,O,b,A[g+3],L,3250441966),b=i(b,y,x,O,A[g+4],S,4118548399),O=i(O,b,y,x,A[g+5],I,1200080426),x=i(x,O,b,y,A[g+6],w,2821735955),y=i(y,x,O,b,A[g+7],L,4249261313),b=i(b,y,x,O,A[g+8],S,1770035416),O=i(O,b,y,x,A[g+9],I,2336552879),x=i(x,O,b,y,A[g+10],w,4294925233),y=i(y,x,O,b,A[g+11],L,2304563134),b=i(b,y,x,O,A[g+12],S,1804603682),O=i(O,b,y,x,A[g+13],I,4254626195),x=i(x,O,b,y,A[g+14],w,2792965006),y=i(y,x,O,b,A[g+15],L,1236535329),b=l(b,y,x,O,A[g+1],R,4129170786),O=l(O,b,y,x,A[g+6],J,3225465664),x=l(x,O,b,y,A[g+11],M,643717713),y=l(y,x,O,b,A[g+0],T,3921069994),b=l(b,y,x,O,A[g+5],R,3593408605),O=l(O,b,y,x,A[g+10],J,38016083),x=l(x,O,b,y,A[g+15],M,3634488961),y=l(y,x,O,b,A[g+4],T,3889429448),b=l(b,y,x,O,A[g+9],R,568446438),O=l(O,b,y,x,A[g+14],J,3275163606),x=l(x,O,b,y,A[g+3],M,4107603335),y=l(y,x,O,b,A[g+8],T,1163531501),b=l(b,y,x,O,A[g+13],R,2850285829),O=l(O,b,y,x,A[g+2],J,4243563512),x=l(x,O,b,y,A[g+7],M,1735328473),y=l(y,x,O,b,A[g+12],T,2368359562),b=s(b,y,x,O,A[g+5],_,4294588738),O=s(O,b,y,x,A[g+8],Z,2272392833),x=s(x,O,b,y,A[g+11],P,1839030562),y=s(y,x,O,b,A[g+14],j,4259657740),b=s(b,y,x,O,A[g+1],_,2763975236),O=s(O,b,y,x,A[g+4],Z,1272893353),x=s(x,O,b,y,A[g+7],P,4139469664),y=s(y,x,O,b,A[g+10],j,3200236656),b=s(b,y,x,O,A[g+13],_,681279174),O=s(O,b,y,x,A[g+0],Z,3936430074),x=s(x,O,b,y,A[g+3],P,3572445317),y=s(y,x,O,b,A[g+6],j,76029189),b=s(b,y,x,O,A[g+9],_,3654602809),O=s(O,b,y,x,A[g+12],Z,3873151461),x=s(x,O,b,y,A[g+15],P,530742520),y=s(y,x,O,b,A[g+2],j,3299628645),b=f(b,y,x,O,A[g+0],k,4096336452),O=f(O,b,y,x,A[g+7],q,1126891415),x=f(x,O,b,y,A[g+14],H,2878612391),y=f(y,x,O,b,A[g+5],N,4237533241),b=f(b,y,x,O,A[g+12],k,1700485571),O=f(O,b,y,x,A[g+3],q,2399980690),x=f(x,O,b,y,A[g+10],H,4293915773),y=f(y,x,O,b,A[g+1],N,2240044497),b=f(b,y,x,O,A[g+8],k,1873313359),O=f(O,b,y,x,A[g+15],q,4264355552),x=f(x,O,b,y,A[g+6],H,2734768916),y=f(y,x,O,b,A[g+13],N,1309151649),b=f(b,y,x,O,A[g+4],k,4149444226),O=f(O,b,y,x,A[g+11],q,3174756917),x=f(x,O,b,y,A[g+2],H,718787259),y=f(y,x,O,b,A[g+9],N,3951481745),b=r(b,p),y=r(y,v),x=r(x,m),O=r(O,C);var X=c(b)+c(y)+c(x)+c(O);return X.toLowerCase()};return b.url=c,b.header=g,b.prototype.constructor=b,b.headers=t,b.setUrl=e,b.addZCLReport=u,b.clearMessages=o,b.removeMessage=a,b.post=f,b.toString=d,b.md5=y,b.debug="",b}();"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=JOA),exports.JOA=JOA):this.JOA=JOA;